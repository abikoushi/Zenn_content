---
title: "グラフ上の拡散方程式"
emoji: "👌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [偏微分方程式,R,数値計算]
published: false
---

[離散化された拡散方程式の状態空間モデル](https://zenn.dev/abe2/articles/10bc59bec3280c)

の続き的な投稿だが記事を行ったり来たりして読む手間を避けるため同じ内容の繰り返しを許して書くことにする.

1次元の拡散方程式

$$
\frac{\partial}{\partial t} u(t,x) = a \frac{\partial}{\partial x^2} u(t,x)
$$

を離散化して $u_{tx}$ ($t=0,1, \ldots ,m$, $x=1, \ldots ,n$) について次の差分方程式を考える.

$$
\begin{aligned}
u_{t+1,x}-u_{t,x} &= a ( u_{t,x+1}-u_{t,x} - (u_{t,x}-u_{t,x-1})  )\\
&=a ( u_{t,x+1}-2u_{t,x}+u_{t,x-1})  )\tag{1}
\end{aligned}
$$

添字が $t$ の変数が全部右辺に, $t+1$ の変数が全部左辺にくるように書き換えると時点 $t$ の状態（現在）から次の $t+1$ での状態（未来）がわかる：

$$
\begin{aligned}
u_{t+1,x} &= u_{t,x} + a ( u_{t,x+1}-2u_{t,x}+u_{t,x-1})  )\\
 &= (1-2a)u_{t,x} + a u_{t,x+1} + au_{t,x-1}
\end{aligned}
$$

$u_t=(u_{t,1}, \ldots , u_{t,n})'$ とまとめると, 次のように行列を使って書くこともできる：

$$
u_{t+1} = \begin{pmatrix}
\ddots& & & &\\ 
& 1-2a & a & 0& \\
&a & 1-2a & a&\\
&0 & a & 1-2a & \\
& & & & \ddots\\ 
\end{pmatrix} u_t. \tag{1'}
$$


ところで