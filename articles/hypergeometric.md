---
title: "フィッシャーの正確確率検定"
emoji: "🌊"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [R, 仮説検定, 信頼区間]
published: false
---

フィッシャーの正確確率検定はフィッシャーの非心超幾何分布を使って二項検定やポアソン検定と同じことをやるだけとも言えるが, 超幾何分布自体がちょっとイメージにしにくいと思うので先に簡単に紹介する.

なんかの要因への曝露（ばくろ; 悪いこととは限らない）によって, ある疾病を持つかどうか調べたところ, 次のようなデータが得られたとしよう.

|| 病気あり | 病気なし |
| ----| ---- | ---- |
|曝露あり|$x$ | $k-x$|
|曝露なし|$m-x$ |$n-(k-x)$ |


この表が得られる確率を計算する一つの方法として,次のような「壺のモデル」が考えられる(Polya's urn の特殊な場合).


|| 黒玉 | 白玉 |
| ----| ---- | ---- |
|取り出した|$x$ | $k-x$|
|取り出してない|$m-x$ |$n-(k-x)$ |


周辺度数（表の縦・横合計）を固定すると, 取りうる値の範囲をすべて書き出すことができ, 表が得られる確率を計算できる.

![](/images/hypergeometric/note_hypergeo.jpg)

（画像は「全部書き出して計算」の例）

この確率分布を超幾何分布という.

超幾何分布は黒玉も白玉も平等な確率で取り出すとしたが, どちらかがより取り出しやいような場合も含むよう拡張したのがフィッシャーの非心超幾何分布（[Fisher's noncentral hypergeometric distribution - Wikipedia](https://en.wikipedia.org/wiki/Fisher%27s_noncentral_hypergeometric_distribution)）である. 通例, つぎのようにオッズ比 $\omega$ を使ってパラメトライズする.

$$
p(x) =  {\frac {{\binom {m_{1}}{x}}{\binom {m_{2}}{n-x}}\omega ^{x}}{P_{0}}}
$$

ここで $P_{0}$ は規格化定数（ここでは省略）.
