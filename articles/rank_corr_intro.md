---
title: "„Çπ„Éî„Ç¢„Éû„É≥„Å®„Ç±„É≥„Éâ„Éº„É´„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞"
emoji: "üìë"
type: "tech" # tech: ÊäÄË°ìË®ò‰∫ã / idea: „Ç¢„Ç§„Éá„Ç¢
topics: [R]
published: true
---

## „Åì„ÅÆ„Éé„Éº„Éà„Å´„Å§„ÅÑ„Å¶

È†ÜÂ∫èÁµ±Ë®àÈáè„Çí‰Ωø„ÅÜÁõ∏Èñ¢‰øÇÊï∞„Å®„Åó„Å¶ÊúâÂêç„Å™2„Å§Ôºå**„Çπ„Éî„Ç¢„Éû„É≥ÔºàSpearmanÔºâ„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞** „Å® **„Ç±„É≥„Éâ„Éº„É´ÔºàKendallÔºâ„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞** „ÇíÁ¥π‰ªã„Åô„ÇãÔºé

„Å®„ÅÑ„Å£„Å¶„ÇÇ„Åª„Å®„Çì„Å©Ë®àÁÆó„É°„É¢„ÅÆ„Çà„ÅÜ„Å™„ÇÇ„ÅÆ„Åß„ÅÇ„ÇãÔºé

„Çø„Ç§ÔºàÂêåÈ†Ü‰ΩçÔºâ„Åå„ÅÇ„Çã„Éá„Éº„Çø„ÅÆ„Å®„Åç„ÅØ„Å°„Çá„Å£„Å®Èõ£„Åó„Åè„Å™„Çã„ÅÆ„Åß„Åì„Åì„Åß„ÅØÊâ±„Çè„Å™„ÅÑÔºé

„Åæ„ÅüÔºå„Åì„ÅÆ„Éé„Éº„Éà„ÅßËø∞„Åπ„Å¶„ÅÑ„Çã„ÇÇ„ÅÆ„ÅØÊ®ôÊú¨Áõ∏Èñ¢‰øÇÊï∞„Å†„Åë„Åß„ÅÇ„ÇäÔºåÁ¢∫ÁéáË´ñ„Åæ„Åß„ÅØÊâ±„Çè„Å™„ÅÑÔºé


## „Éî„Ç¢„ÇΩ„É≥„ÅÆÁ©çÁéáÁõ∏Èñ¢‰øÇÊï∞„Åã„Çâ„Çπ„Éî„Ç¢„Éû„É≥„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞„Å∏


Âçò„Å´Áõ∏Èñ¢‰øÇÊï∞„Å®Ë®Ä„ÅÜ„Å®„Åç„ÅØ **„Éî„Ç¢„ÇΩ„É≥ÔºàPearsonÔºâ„ÅÆÁ©çÁéáÁõ∏Èñ¢‰øÇÊï∞** „ÇíÊåá„Åô„Åì„Å®„ÅåÂ§ö„ÅÑÔºéÁµÑ„ÅÆ„Éá„Éº„Çø $(x_iÔºåy_i)$Ôºå($i=1,\ldots n$) „ÅåÂæó„Çâ„Çå„Åü„Å®„ÅçÔºå„Éî„Ç¢„ÇΩ„É≥„ÅÆÁ©çÁéáÁõ∏Èñ¢‰øÇÊï∞ $r$ „ÅØÊ¨°„ÅÆÂºè„ÅßÊ±Ç„ÇÅ„Çâ„Çå„ÇãÔºé

$$
r = \frac{\sum_{i=1}^n (x_i - \bar x)(y_i - \bar y)}{\sqrt{\sum_{i=1}^n (x_i - \bar x)^2}\sqrt{\sum_{i=1}^n (y_i - \bar y)^2}} \tag{P}
$$

„Åü„Å†„Åó„Åì„Åì„Åß„ÅØ $\bar x= \frac{1}{n}\sum_{i=1}^n x_i$ „Å®„Åó„Åü.

‰∏ÄÊñπ„ÅßÔºåÁµÑ„ÅÆ„Éá„Éº„Çø„ÅÆÈ†Ü‰Ωç $(x_iÔºåy_i)$Ôºå($i=1,\ldots n$) „ÅåÂæó„Çâ„Çå„Åü„Å®„ÅçÔºå„Çπ„Éî„Ç¢„Éû„É≥„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞ $\rho$ „ÅØÊ¨°„ÅÆÂºè„ÅßÊ±Ç„ÇÅ„Çâ„Çå„ÇãÔºé

$$
\rho = 1-\frac{6\sum_{i=1}^n (x_i - y_i)^2}{n(n^2-1)} \tag{S}
$$

„Éî„Ç¢„ÇΩ„É≥„ÅÆÁ©çÁéáÁõ∏Èñ¢‰øÇÊï∞„ÅåËâ≤„ÄÖ„Å™Áõ∏Èñ¢‰øÇÊï∞„ÅÆÂü∫Êú¨„ÅÆ„Çà„ÅÜ„Å´ÊÄù„Åà„Çã„ÅÆ„ÅßÔºå„Åæ„Åö„Éî„Ç¢„ÇΩ„É≥„ÅÆÁ©çÁéáÁõ∏Èñ¢‰øÇÊï∞„ÅÆÂºè„ÅÆÊÑèÂë≥„Çí‰∏ÄÂ∫¶ËÄÉ„Åà„Å¶„Åø„ÇãÔºé

ÊñáÂ≠ó„ÅåÂ§ö„ÅÑ„Å®Â§ßÂ§â„Å™„ÅÆ„ÅßÔºå‰ªÆ„Å´ $\bar x$ „Å® $\bar y$ „Åå„Å©„Å°„Çâ„ÇÇ 0 „Å®„Åó„Å¶„Åø„ÇãÔºé

$$
r = \frac{\sum_{i=1}^n x_iy_i}{\sqrt{\sum_{i=1}^n x_i^2}\sqrt{\sum_{i=1}^n y_i^2}}. \tag{P0}
$$

„Åì„Çå„ÅØ2„Å§„ÅÆ„Éô„ÇØ„Éà„É´ $x=(x_1,\ldots x_n)'$, $y=(y_1,\ldots y_n)'$ „ÅÆÂÜÖÁ©ç $\langle x,y\rangle = \sum_{i=1}^n x_iy_i$ „Çí„Åù„Çå„Åû„Çå„ÅÆÈï∑„Åï $\|x\|=\sqrt{\sum_{i=1}^n x_i^2}$, $\|y\|=\sqrt{\sum_{i=1}^n y_i^2}$ „ÅßÂâ≤„Å£„Åü„ÇÇ„ÅÆÔºå„Å§„Åæ„Çä2„Å§„ÅÆ„Éô„ÇØ„Éà„É´„ÅÆ„Å™„ÅôËßí„ÅÆ„Ç≥„Çµ„Ç§„É≥„Å´„Å™„Å£„Å¶„ÅÑ„ÇãÔºé„Åù„ÅÆ„Åü„ÇÅ (P0) „ÅÆ $r$ „Çí **„Ç≥„Çµ„Ç§„É≥È°û‰ººÂ∫¶Ôºàcosine similalrityÔºâ** „Å®Âëº„Å∂„Åì„Å®„ÇÇ„ÅÇ„ÇãÔºé

$\bar x = 0$Ôºå$\bar y=0$ „ÅØ $x_i$Ôºå$y_i$ „Åã„Çâ„Åù„Çå„Åû„Çå„ÅÆÊ®ôÊú¨Âπ≥Âùá„ÇíÂºï„ÅÑ„Åü„ÇÇ„ÅÆ„ÇíÊîπ„ÇÅ„Å¶ $x_i$Ôºå$y_i$ „Å®„Åø„Çå„Å∞ÈÅîÊàê„Åï„Çå„Çã„ÅÆ„ÅßÔºåÁõ∏Èñ¢‰øÇÊï∞„ÅØÂπ≥Âùá„Åã„Çâ„ÅÆ„Ç∫„É¨ÂÖ∑Âêà„Å´„Å§„ÅÑ„Å¶„ÅÆ„Ç≥„Çµ„Ç§„É≥È°û‰ººÂ∫¶„Åß„ÅÇ„ÇãÔºé

„Ç≥„Çµ„Ç§„É≥„Åß„ÅÇ„Çã„Åã„ÇâÁõ∏Èñ¢‰øÇÊï∞„ÅØ $-1\le r \le 1$ „Åß„ÅÇ„ÇãÔºé

„Åì„Åì„Åß„ÅØÁ¢∫ÁéáË´ñ„Å´„Å§„ÅÑ„Å¶„ÅØ„Åª„Å®„Çì„Å©Ëß¶„Çå„Å™„ÅÑ„ÅÆ„ÅßÔºåÁ∑öÂΩ¢‰ª£Êï∞„ÅÆÊïôÁßëÊõ∏„Å®Êï∞ÁêÜÁµ±Ë®à„ÅÆÊïôÁßëÊõ∏„ÇíË¶ãÊØî„Åπ„Å™„Åå„ÇâÂãâÂº∑„Åô„ÇãÂ†¥Âêà„ÅÆ„Åü„ÇÅ„Å´ÔºåÊ®°ÂºèÁöÑ„Å´ÂØæÂøú„ÇíÊõ∏„ÅÑ„Å¶„Åä„ÅèÔºé

|Êï∞„Éô„ÇØ„Éà„É´„ÅÆÂ†¥Âêà|Á¢∫ÁéáÂ§âÊï∞„ÅÆÂ†¥Âêà|
|--|--|
|Èï∑„Åï|Ê®ôÊ∫ñÂÅèÂ∑Æ|
|ÂÜÖÁ©ç|ÂÖ±ÂàÜÊï£|
|„Å™„ÅôËßí $\theta$ „ÅÆ $\cos(\theta)$|Áõ∏Èñ¢‰øÇÊï∞|

‰æã„Åà„Å∞ÂÜÖÁ©ç„Å´„Å§„ÅÑ„Å¶„ÅÆ„Ç≥„Éº„Ç∑„ÉºÔºù„Ç∑„É•„ÉØ„É´„ÉÑ„ÅÆ‰∏çÁ≠âÂºè„Å´„Å§„ÅÑ„Å¶Ôºå

$$
\begin{aligned}
\langle x,y\rangle ^{2} &\leq \langle x,x\rangle \cdot \langle y,y\rangle \\
& =\|x\|^2 \cdot \|y\|^2
\end{aligned}
$$

$x$, $y$ „ÇíÁ¢∫ÁéáÂ§âÊï∞ $X$, $Y$ „Å®„Åó„Å¶ÔºåÂÜÖÁ©ç„ÇíÂÖ±ÂàÜÊï£ $\mathrm{Cov}(X,Y)$ „Å®ÂàÜÊï£ $\mathrm{Var}(X)=\mathrm{Cov}(X,X)$ „Å´ÁΩÆ„ÅçÊèõ„ÅàÔºå

$$
\begin{aligned}
\mathrm{Cov}(X,Y)^2 &\leq \mathrm{Cov}(X,X) \cdot \mathrm{Cov}(Y,Y)\\
&=\mathrm{Var}(X) \cdot \mathrm{Var}(Y)
\end{aligned}
$$

„Å®„Åó„Åü„ÇÇ„ÅÆ„ÇÇÊàê„ÇäÁ´ã„Å°Ôºå„Åì„Çå„ÇÇ„Ç≥„Éº„Ç∑„ÉºÔºù„Ç∑„É•„ÉØ„É´„ÉÑ„ÅÆ‰∏çÁ≠âÂºè„Å®Âëº„Å∂Ôºé

„Åï„Å¶Ôºå (S)„ÅÆÂºè„ÅÆ„Çπ„Éî„Ç¢„Éû„É≥„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞„Å´„ÅØ2„Å§„ÅÆ„Éô„ÇØ„Éà„É´„ÅÆË∑ùÈõ¢„ÅÆ2‰πó

$$
d^2(x,y) = \sum_{i=1}^n (x_i - y_i)^2
$$

„ÅåÁèæ„Çå„Å¶„ÅÑ„ÇãÔºé

Ôºí„Å§„ÅÆ„Éô„ÇØ„Éà„É´ $x$, $y$ „ÅÆË∑ùÈõ¢ $d(x,y)$ „ÅØÊ¨°„ÅÆ„Çà„ÅÜ„Å´„ÇÇÊõ∏„Åë„ÇãÔºé

$$
\begin{aligned}
d(x,y) &= \sqrt{\sum_{i=1}^n (x_i-y_i)^2}\\
&=\sqrt{\left(\sum_{i=1}^n x_i^2\right)+\left(\sum_{i=1}^ny_i^2\right) - 2\left(\sum_{i=1}^nx_iy_i\right)}\\
&=\sqrt{\| x \|^2 + \|y\|^2 - 2\langle x, y\rangle}
\end{aligned}
$$

„É´„Éº„Éà„ÅÆ‰∏≠„ÅÆÁ¨¨1È†ÖÔºåÁ¨¨2È†Ö„ÅØ0‰ª•‰∏ä„Åß„ÅÇ„ÇäÔºåÂÜÖÁ©ç $\langle x,y\rangle$ „ÇíÂê´„ÇÄÈ†Ö„ÅÆÁ¨¶Âè∑„Åå„Éû„Ç§„Éä„Çπ„Å´„Å™„Å£„Å¶„ÅÑ„Çã„ÅÆ„ÅßÔºåÂÜÖÁ©ç„ÅåÂ§ß„Åç„ÅÑ„Åª„Å©Ë∑ùÈõ¢„ÅØÂ∞è„Åï„ÅèÔºåÂÜÖÁ©ç„ÅåÂ∞è„Åï„ÅÑ„Åª„Å©Ë∑ùÈõ¢„ÅØÂ§ß„Åç„Åè„Å™„Çã„Åì„Å®„Åå„Çè„Åã„ÇãÔºé

ÂÜÖÁ©ç„ÇíÔºåÊ¨°„ÅÆ„Çà„ÅÜ„Å´Ë∑ùÈõ¢„ÅåÊòéÁ§∫ÁöÑ„Å´Áèæ„Çå„ÇãÂΩ¢„ÅßÊõ∏„Åè„Åì„Å®„ÇÇ„Åß„Åç„ÇãÔºé

$$
\langle x, y\rangle =\frac{1}{2} \left(  \| x \|^2 + \|y\|^2  -d^2(x,y) \right)
$$

„Åì„Çå„Çí‰Ωø„Å£„Å¶ÔºåÁõ∏Èñ¢‰øÇÊï∞ $r$ „ÇíË∑ùÈõ¢„ÅåÊòéÁ§∫ÁöÑ„Å´Áèæ„Çå„ÇãÂΩ¢„ÅßÊõ∏„ÅÑ„Å¶„Åø„ÇãÔºé„Åì„Çì„Å™„Åµ„ÅÜ„Å†Ôºé

$$
\begin{aligned}
r &= \frac{\left(\sum_{i=1}^n x_iy_i \right) - n\bar{x}\bar{y}}{(\left\{ \sum_{i=1}^n x_i^2 \right\} - n\bar{x}^2)^{1/2} \cdot (\left\{ \sum_{i=1}^n y_i^2\right\} - n\bar{y}^2)^{1/2}}\\
&=\frac{\langle x, y\rangle - n\bar{x}\bar{y}}{(\|x \|^2- n\bar{x}^2)^{1/2} \cdot (\| y\|^2 - n\bar{y}^2)^{1/2}}\\
&=\frac{\frac{1}{2} \left\{\|x\|^2 + \|y\|^2 - d^2(x,y) \right\}- n\bar{x}\bar{y}}{(\|x \|^2- n\bar{x}^2)^{1/2} \cdot (\| y\|^2 - n\bar{y}^2)^{1/2}}
\end{aligned}
$$

„ÅÑ„ÅæÔºå$x_i$Ôºå$y_i$ „ÅØ„Å©„Å°„Çâ„ÇÇ1„Åã„Çâ $n$ „Åæ„Åß„ÅÆÈáçË§á„ÅÆ„Å™„ÅÑËá™ÁÑ∂Êï∞„Å®„ÅóÔºå„Éá„Éº„Çø„Å´ÂÄ§„ÅÆÂ∞è„Åï„ÅÑÈ†Ü„Å´ÊåØ„Çâ„Çå„ÅüÈ†Ü‰Ωç„ÇíË°®„Åô„Å®„Åô„ÇãÔºé„Åì„ÅÆ„Å®„ÅçÔºåÊ¨°„ÅÆ2„Å§„ÅåÊàê„ÇäÁ´ã„Å§Ôºé

$$
\begin{aligned}
n\bar{x}= \sum_{i=1}^n x_i & =\sum_{i=1}^n y_i = n\bar{y} ,\\
\|x\|^2 = \sum_{i=1}^n x_i^2 &=\sum_{i=1}^n y_i^2 = \|y\|^2.
\end{aligned}
$$

„Åù„ÅÆ„Åü„ÇÅÔºå

$$
\begin{aligned}
r &= \frac{\frac{1}{2} \left\{  2\| x \|^2 - d^2(x,y) \right\}- n\bar{x}^2}{\|x \|^2- n\bar{x}^2}\\
&= 1 - \frac{\frac{1}{2}d^2(x,y)}{\|x \|^2- n\bar{x}^2}
\end{aligned}
$$

„Å®„Å™„ÇãÔºé„Åï„Çâ„Å´Âè≥Ëæ∫Á¨¨2È†Ö„ÅÆÂàÜÊØç„Å´„Å§„ÅÑ„Å¶Êï¥ÁêÜ„Åô„ÇãÔºé

$$
\begin{aligned}
\text{(ÂàÜÊØç)} &= \left(\sum_{i=1}^n x_i^2\right) - \frac{1}{n}\left(\sum_{i=1}x_i\right)^2\\
&= \left(\sum_{i=1}^n i^2\right) - \frac{1}{n}\left(\sum_{i=1}i\right)^2\\
&= \frac{1}{6} n (n+1)(2n+1) - \frac{1}{n}\left(\frac{1}{2}n(n+1)\right)^2\\
&=\frac{1}{12} ( n(n+1) [ 2(2n+1 )- 3(n+1)] )\\
&=\frac{1}{12} n(n^2-1)
\end{aligned}
$$

ÁµêÊûúÔºå$(x_iÔºåy_i)$ „ÅåÈ†Ü‰Ωç„ÅÆ„Å®„Åç„ÅØÔºå

$$
r = \rho = 1-\frac{6\sum_{i=1}^n (x_i - y_i)^2}{n(n^2-1)}
$$

„Å®„Å™„Çä (S) „Å®‰∏ÄËá¥„Åô„Çã„Åì„Å®„Åå„Çè„Åã„Å£„ÅüÔºé„Åô„Å™„Çè„Å°Ôºå„Çπ„Éî„Ç¢„Éû„É≥„ÅÆÈ†ÜÂ∫èÁõ∏Èñ¢‰øÇÊï∞„ÅØÔºåÂçò„Å´ $(x_iÔºåy_i)$ „ÇíÈ†Ü‰Ωç„Å´Â§âÊèõ„Åó„Å¶„Åã„Çâ„Éî„Ç¢„ÇΩ„É≥„ÅÆÁ©çÁéáÁõ∏Èñ¢‰øÇÊï∞„ÇíÊ±Ç„ÇÅ„Åü„ÇÇ„ÅÆ„Å†„Å®„Çè„Åã„Å£„ÅüÔºé

‰∏ÄËà¨„Å´Ôºå$0 \le d^2(xÔºåy) \le D_{\max}$ „Å™„Çâ„Å∞

$$
-1 \le 1 - \frac{d^2(xÔºåy)}{D_{\max}/2} \le 1 \tag{I}
$$

„Åß„ÅÇ„ÇãÔºé Á¨¶Âè∑„ÇíÂèçËª¢„Åï„Åõ„Åü $\frac{d^2(xÔºåy)}{D_{\max}/2}-1$ „ÇÇ-1„Åã„Çâ1„ÅÆÁØÑÂõ≤„Å´Âèé„Åæ„Çã„ÅåÔºåË∑ùÈõ¢„ÅåÂ§ß„Åç„ÅÑ„Åª„Å©Áõ∏Èñ¢‰øÇÊï∞„ÅØÂ∞è„Åï„Åè„Å™„Å£„Å¶„Åª„Åó„ÅÑ„ÅÆ„ÅßÁõ∏Èñ¢‰øÇÊï∞„Å®„Åó„Å¶„ÅØ $1 - \frac{d^2(xÔºåy)}{D_{\max}/2}$ „ÅÆ„Åª„ÅÜ„ÇíÊé°Áî®„Åô„ÇãÔºé

$d^2(xÔºåy)$ „ÅÆÂèñ„Çä„ÅÜ„ÇãÊúÄÂ§ßÂÄ§ $D_{\max}$ „ÅØ

$$
D_{\max} = \sum_{i=1}^n(i-(n-i+1))^2 = n(n^2-1)/3
$$

„Åß„ÅÇ„Çã„Åã„ÇâÔºå„Åì„Åì„Åã„Çâ„ÇÇ $\rho$ „Åå (I)„ÅÆ‰∏çÁ≠âÂºè„ÇíÊ∫Ä„Åü„Åô„Åì„Å®„Åå„Çè„Åã„ÇãÔºé

## „Çπ„Éî„Ç¢„Éû„É≥„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞„Åã„Çâ„Ç±„É≥„Éâ„Éº„É´„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞„Å∏

È†ÜÂ∫èÁµ±Ë®àÈáè„Çí‰Ωø„ÅÜÁõ∏Èñ¢‰øÇÊï∞„Å®„Åó„Å¶ÊúâÂêç„Å™„ÇÇ„ÅÆ„Å´„ÇÇ„ÅÜ‰∏Ä„Å§Ôºå„Ç±„É≥„Éâ„Éº„É´„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞„Åå„ÅÇ„ÇãÔºé

„Çπ„Éî„Ç¢„Éû„É≥„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞„Åß„ÅØË∑ùÈõ¢„ÅÆ2‰πó„Å®„Åó„Å¶Â∑Æ„ÅÆ2‰πó„ÅÆÁ∑èÂíå„ÇíÊé°Áî®„Åó„Å¶„ÅÑ„ÅüÔºé

Áµ±Ë®à„É¢„Éá„É´„ÇíÁêÜËß£„Åô„Çã‰∏ä„Åß„ÅØÔºå„Éá„Éº„Çø„ÅåÂêå„Åò„Åß„ÇÇË∑ùÈõ¢„ÅÆÊ∏¨„ÇäÊñπ„Çí„ÅÑ„Çç„ÅÑ„ÇçÂ§â„Åà„Å¶„Åø„Çã„Åì„Å®„Åå„Åß„Åç„Çã„Å®„ÅÑ„ÅÜÁô∫ÊÉ≥„ÅåÂ§ß‰∫ã„Å´„Å™„Çã„Çà„ÅÜ„Å´ÊÄù„ÅÜÔºé

„Åù„Åì„ÅßÔºå$x$ „Çí $y$ „Å®‰∏ÄËá¥„Åï„Åõ„Çã„Åü„ÇÅ„Å´ÂøÖË¶Å„Å™ÂÖ•„ÇåÊõø„Åà„ÅÆÂõûÊï∞„ÇíË∑ùÈõ¢„ÅÆ2‰πó„Å®„Åó„Å¶„Åø„Çà„ÅÜÔºé$K$ Âõû„ÅÆÂÖ•„ÇåÊõø„Åà„ÅåÂøÖË¶Å„Å™„Å®„ÅçË∑ùÈõ¢ $d^2(x,y)=K$ „Åß„ÅÇ„ÇãÔºé

„Åü„Å®„Åà„Å∞Ôºå$x=(1,3,2)'$ , $y=(1,2,3)'$ „Å™„ÇâÔºå2„Å§„ÇÅ„Å®3„Å§„ÇÅ„Çí1ÂõûÂÖ•„ÇåÊõø„Åà„Çã„Å®‰∏ÄËá¥„Åô„Çã„ÅÆ„Åß $d^2(x,y)=1$ „Åß„ÅÇ„Çã.

‰∏ÄËà¨„Å´Ôºå„ÇÇ„Çå„Å™„Åè„ÉÄ„Éñ„Çä„Å™„Åè‰ΩïÂõû„ÅÆÂÖ•„ÇåÊõø„Åà„ÅåÂøÖË¶Å„ÅãÊï∞„Åà„Çã„ÅÆ„ÅØ„Å©„ÅÜ„Åó„Åü„Çâ„ÅÑ„Å†„Çç„ÅÜ„ÅãÔºé

Ê¨°„ÅÆË°®„Çí‰æã„Å´ËÄÉ„Åà„ÇãÔºé

|x|y|
|--|--|
|3|4|
|1|2|
|4|3|
|2|1|

„Åæ„Åö $y$ „Çí„Ç≠„Éº„Å´„ÇΩ„Éº„Éà„Åô„ÇãÔºé

|x|y|
|--|--|
|2|1|
|1|2|
|4|3|
|3|4|


Ë°®„ÅÆ $i$ Ë°åÁõÆ„Çà„Çä‰∏ã„Å´„ÅÇ„Çã„ÇÇ„ÅÆ„ÅÆ„ÅÜ„Å°Ôºå$x_i$ „Çà„ÇäÂ§ß„Åç„ÅÑ„ÇÇ„ÅÆ„ÅØÂÖ•„ÇåÊõø„Åà„ÅåÂøÖË¶Å„Åå„Å™„ÅÑÔºé„Åì„ÅÆÊï∞ $c_i$ „ÅÆÂêàË®à„Çí $S=\sum_{i=1}^n c_i$ „Å®„Åô„ÇãÔºé

ÂÖà„ÅÆ‰æã„Åß„ÅØÔºå$S$ „ÅØÊ¨°„ÅÆË°®„ÅÆÂ§™Â≠ó„ÅÆÈÉ®ÂàÜ„ÅÆÊï∞„ÅßÔºå$c_1=2$, $c_2=2$, $c_3=0$, $c_4=0$ „Åß„ÅÇ„ÇãÔºé

|1Ë°åÁõÆ„Å´Ê≥®ÁõÆ|2Ë°åÁõÆ„Å´Ê≥®ÁõÆ|3Ë°åÁõÆ„Å´Ê≥®ÁõÆ|4Ë°åÁõÆ„Å´Ê≥®ÁõÆ|
|--|--|--|--|
|2||||
|1|1|||
|**4**|**4**|4||
|**3**|**3**|3|3|

ÊúÄÂ§ß„ÅÆÂÖ•„ÇåÊõø„ÅàÂõûÊï∞„ÅØ‰∫åÈ†Ö‰øÇÊï∞„Çí‰Ωø„Å£„Å¶ $\binom{n}{2}=n(n-1)/2$ „Å®Êõ∏„Åë„Çã„ÅÆ„ÅßÔºå

$$
K=n(n-1)/2-S
$$

„Åß„ÅÇ„ÇãÔºéÂÖà„ÅÆ‰æã„Åß„ÅØ $K=6-4=2$ „Åß„ÅÇ„ÇãÔºé

$0 \le K \le n(n-1)/2$ „Çà„Çä(I)„ÅÆÈñ¢‰øÇ„Çí‰Ωø„Å£„Å¶Ôºå

$$
\tau = 1 - \frac{K}{n(n-1)/4}
$$

„Å®„Åô„Çã„Å® $-1 \le \tau \le 1$ „ÇíÊ∫Ä„Åü„ÅôÔºé $\tau$ „Çí„Ç±„É≥„Éâ„Éº„É´„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞„Å®Âëº„Å∂Ôºé

„Ç±„É≥„Éâ„Éº„É´„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞„ÅØÔºå„Çπ„Éî„Ç¢„Éû„É≥„ÅÆÈ†Ü‰ΩçÁõ∏Èñ¢‰øÇÊï∞„Å´„Åä„ÅÑ„Å¶ÔºåË∑ùÈõ¢„ÅÆ2‰πó„Çí„Äå2„Å§„ÅÆÈ†Ü‰Ωç„Çí‰∏ÄËá¥„Åï„Åõ„Çã„Åü„ÇÅ„Å´ÂøÖË¶Å„Å™ÂÖ•„ÇåÊõø„Åà„ÅÆÂõûÊï∞„ÄçÔºà„Åì„ÅÆË∑ùÈõ¢„Å´„ÅØ„Åü„Å∂„Çì„Å™„Å´„ÅãÂêçÂâç„Åå„Å§„ÅÑ„Å¶„ÅÑ„Çã„Å®ÊÄù„ÅÜ„ÅåË¶ã„Å§„Åã„Çâ„Å™„Åã„Å£„ÅüÔºâ„Å´Â§â„Åà„Åü„ÇÇ„ÅÆ„Åß„ÅÇ„ÇãÔºé

## R „Å´„Çà„ÇãË®àÁÆó‰æã

R „ÅÆ `cor` Èñ¢Êï∞„ÅØ `method = "spearman"` „ÇÑ `method = "kendall"` „ÇÇÂÆüË£Ö„Åï„Çå„Å¶„ÅÑ„ÇãÔºà„Éá„Éï„Ç©„É´„Éà„ÅØ `method = "pearson"`ÔºâÔºé

„ÅÇ„Åæ„Çä„Åä„ÇÇ„Åó„Çç„ÅÑ‰æã„Åå‰Ωú„Çå„Å™„Åã„Å£„Åü„ÅåÔºå„Åì„Çì„Å™ÊÑü„Åò„ÅßÁ≠î„ÅàÂêà„Çè„Åõ„Åå„Åß„Åç„ÇãÔºé

```r
set.seed(0705)
n=11
x = rnorm(n)
y = rnorm(n)

tau0 = cor(x, y, method = "kendall")
R = rank(x[order(y)])
S = sum(sapply(1:(n-1),function(i)sum(R[(i+1):n] > R[i])))
K = choose(n,2)-S
Kmax = choose(n,2)
tau = 1-K/(Kmax/2)

cat("our implementation", tau, ", stats::cor", tau0)
###
rho0 = cor(x, y, method = "spearman")
D2 = sum((rank(x)-rank(y))^2)
D2max = n*(n+1)*(n-1)/3
rho = 1-D2/(D2max/2)
cat("our implementation", rho, ", stats::cor", rho0)
```

```r
cat("our implementation", tau, ", stats::cor", tau0)
our implementation -0.01818182 , stats::cor -0.01818182

cat("our implementation", rho, ", stats::cor", rho0)
our implementation -0.06363636 , stats::cor -0.06363636
```

„Åä„Åó„Åæ„ÅÑÔºé